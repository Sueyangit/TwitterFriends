<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Twitter Friends</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/blood.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Fuentes molonas con iconos para la presentación -->
		<link rel="stylesheet" href="font-awesome/css/font-awesome.min.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<h2>Following y Followers:</h2>
					<h3>Más que números</h3>
					<p>Marta Gómez y Braulio Vargas</p>
					<p style="margin-top: 5%">
			      			<a href="https://twitter.com/Mrs_DarkDonado" style="float:left; color:#0D86FF"><i class="fa fa-twitter fa-2x" aria-hidden="true"></i> @Mrs_DarkDonado</a>
			      			<a href="https://twitter.com/brau_vl" style="float:right; color:#0D86FF"><i class="fa fa-twitter fa-2x" aria-hidden="true"></i> @brau_vl</a>
			    		</p>
                </section>
                <section>
                    <h3>Sobre nosotros</h3>
                    <div style="width: 100%">
                        <div style="float: left; width: 45%">
                            <div class="circular" style="background-image: url(images/brau.jpg);"></div>
                            <ul style="font-size: 25px">
                                <li>Estudiante de Ingeniería Informática con mención en <b>Computación y Sistemas Inteligentes</b>.</li>
                                <li>Organizador de <b>Python Granada</b>.</li>
                                <li>Colaborador en <b>Geek & Tech Girls</b>.</li>
                            </ul>
                        </div>
                        <div style="float: right; width: 45%">
                            <div class="circular" style="background-image: url(images/marta.jpg); float: right;"></div>
                            <ul style="font-size: 25px;">
                                <li>Estudiante de Ingeniería Informática con mención en <b>Computación y Sistemas Inteligentes</b>.</li>
                                <li>Fundadora de <b>Geek & Tech Girls</b>.</li>
                                <li>Organizadora de <b>Python Granada</b>.</li>
                            </ul>
                        </div>
                    </div>
                    <div style="clear: both;"></div>
                </section>
				</section>
				<section>
					<section>
						<h3>Twitter Friends</h3>
						<ul class="fragments">
							<li class="fragment">Aplicación Django que genera una red con nuestros contactos en Twitter.</li>
							<li class="fragment">Dicha red se construye guardando los "siguiendo" (amigos) de un usuario y los de sus amigos.</li>
						</ul>
					</section>
					<section data-background="#fff" data-background-transition="zoom">
                        <img src="images/graph.png" style="height: 50%; width: 50%; box-shadow: none; border:0">
                    </section>
					<section data-background-image="images/interfaz.png">
						<p> </p>
					</section>
				</section>
				<section>
					<section>
						<h3>¿Cómo funciona?</h3>
						<ol class="fragments">
							<li class="fragment">Usa <b>Tweepy</b> para descargar datos de Twitter.</li>
							<li class="fragment">Empezando por el usuario que lanza la aplicación, descarga sus amigos y todos los amigos de sus amigos.</li>
							<li class="fragment">Estos datos se guardan en una base de datos <b>sqlite3</b></li>
							<li class="fragment">Desde el navegador, el usuario selecciona en qué formato quiere la red y la aplicación se la devuelve.</li>
						</ol>
					</section>
                    <section data-background="https://media.giphy.com/media/E7E3TseKm6Ry0/giphy.gif"></section>
					<section>
						<h3>Conectando con Tweepy</h3>
						<pre><code class="hljs" data-trim contenteditable>
import tweepy
from os import environ
from findfriends.models import TwitterUser
environ.setdefault("DJANGO_SETTINGS_MODULE", 
				  "TwitterFriends.settings")

# Las claves de acceso a twitter están definidas como 
# variables de entorno
auth = tweepy.OAuthHandler(environ["TWITTER_CONSUMER_KEY"], 
                           environ["TWITTER_CONSUMER_SECRET"])
auth.set_access_token(environ["TWITTER_ACCESS_TOKEN"], 
                      environ["TWITTER_ACCESS_TOKEN_SECRET"])
api = tweepy.API(auth_handler=auth, 
	wait_on_rate_limit_notify=True, 
    wait_on_rate_limit=True)

					</code></pre>
					</section>
					<section>
						<h3>Modelo de Usuario de Twitter</h3>
						<pre><code class="hljs" data-trim contenteditable>
class TwitterUser(models.Model):
    # id numérico del usuario en twitter.
    user_id = models.IntegerField(unique=True)
    # nombre de usuario en twitter (@...).
    screen_name = models.CharField(unique=True, max_length=50)
    # flag para saber si es una cuenta verificada
    is_verified = models.BooleanField()
    # localización del usuario
    location = models.CharField(max_length=50)
    # lista de amigos del usuario.
    friends = models.ManyToManyField('self', symmetrical=False, 
    					blank=True)

    def __str__(self):
		return self.screen_name

					</code></pre>
					</section>
										<section>
						<h3>Guardando usuarios</h3>
						<pre><code class="hljs" data-trim contenteditable>
def save_user(user):
    if not TwitterUser.objects.filter(user_id=user.id).exists():
        print("Saving: ",user.screen_name)
        u = TwitterUser()
        u.user_id = user.id
        u.screen_name = user.screen_name
        u.is_verified = user.verified
        u.location = user.location
        u.save()
    else:
        print(user.screen_name, " is already on the data base")


def get_and_save_friends(user_id):
    global n_calls
    for friend in tweepy.Cursor(api.friends, 
    			user_id=user_id, count=200).items():
		save_user(friend)

# guardamos el objeto usuario del usuario 
# identificado en la base de datos
me = api.me()
save_user(me)
# guardamos sus amigos y los amigos de sus 
# amigos en la base de datos
get_and_save_friends(user_id=me.id)
amigos = api.friends_ids(user_id=me.id)
for amigo in amigos:
	get_and_save_friends(user_id=amigo)
					</code></pre>
					</section>
					<section>
						<h3>Creando las relaciones de amistad</h3>
						<pre><code class="hljs" data-trim contenteditable>
# function to save frienship on database
def create_frienship(api, userid):
    user = TwitterUser.objects.get(user_id=userid)
    if len(user.friends.all()) == 0:
        friends = api.friends_ids(user_id=userid)
        print("Saving ", user.screen_name, "'s friends")
        for friend in friends:
            if TwitterUser.objects.filter(user_id=friend)
            		.exists():
                u = TwitterUser.objects.get(user_id=friend)
                print(u.screen_name, " is friend of ", 
                	user.screen_name)
                user.friends.add(u)
    else:
		print(user.screen_name, "'s friends are 
				already saved")

me = api.me()

# guardamos los amigos del usuario identificado
amigos = api.friends_ids(user_id=me.id)
create_frienship(api=api, userid=me.id)
# guardamos los amigos de los amigos del usuario identificado
for amigo in amigos:
    if TwitterUser.objects.filter(user_id=amigo).exists():
		create_frienship(api=api, userid=amigo)
					</code></pre>
					</section>
				</section>
				<section>
					<h3>Una forma diferente de extraer datos...</h3>
					<p class="fragment">Este tipo de datos en forma de grafo nos permite extraer información distinta a la que podríamos obtener estudiando únicamente los RT, MG o número de seguidores del usuario.</p>
					<ul class="fragments">
						<li class="fragment">Detección de comunidades.</li>
						<li class="fragment">Detección de personas más influyentes o populares.</li>
						<li class="fragment">Estudio de la influencia/alcance de un usuario concreto en una red.</li>
					</ul>
				</section>
				<section>
					<h2>Una forma diferente de extraer datos</h2><h3>Influencia de Python Granada en Twitter</h3>
				</section>
				<section>
					<section>
						<h2>Antes de empezar...</h2>
						<h3>¿Qué son las redes de amistad?</h3>
					</section>
					<section>
						<h2>Following</h2>
						En Twitter, todos seguimos a ciertas personas
						<img src="./images/following.png" style="width: 50%">
					</section>
					<section>
						<h2>Followers</h2>
						Y también nos siguen ciertas personas, que no tienen por qué ser nuestros following
						<p><img src="./images/followers.png" style="width: 50%"></p>
						<p>Como es el caso de <b>Pepe</b>.</p>
					</section>
					<section>
						<p>Tanto los <i>Following</i> como los <i>Followers</i> forman grafos dirigidos, donde las aristas representan la relación de seguimiento.</p>

						<p>Por tanto, si fusionamos ambos grafos, podemos obtener una representación de la red de seguimiento en Twitter o...</p>
					</section>
					<section><h2>Redes de Amistad</h2></section>
					<section data-background="https://media.giphy.com/media/3o72F8t9TDi2xVnxOE/giphy.gif"></section>
				</section>
				<section>
					Todo eso está muy bien, el nombre vende un montón, pero se queda algo en el tintero
					<h3>¿Ahora qué?</h3>
				</section>
				<section><p>El hecho de conocer la red o grafo subyacente nos permite ir más allá de conocer datos de un usuario. Es decir, con un usuario podemos conocer la ubicación, el número de following/followers, ubicación, etc. </p>
				<p>Pero ahora se puede llevar un nivel más allá:</p>
				<h4>A toda una comunidad.</h4></section>
				<section>
				<h3>También podemos conocer:</h3>
				<ul>
					<li>¿Quién es el que de verdad manda en una organización?</li>
					<li>Y los más cercanos a él.</li>
					<li>Simular cómo se expandería una noticia o rumor usando una simulación en agentes.</li>
					<li>Y conocer otros datos más concretos basados en las propiedades de la red.</li>
				</ul>
				</section>
				<section>
					<h2>¿Cómo analicé la influencia de Python Granada en Twitter?</h2>
				</section>
                <section>
					<section>
						<h2>Centralidad de los nodos</h2>
						<p>No es difícil analizar cómo es un nodo de central en la red, aunque existen distintas medidas para analizar esto.</p>
					</section>
					<section>
						<h3>Centralidad de Grado</h3>
						Un nodo es más importante o central en la red cuanto mayor es el grado de ese nodo. Estos nodos como un grado muy alto se conocen como <b><i>Hubs</i></b>.
						<h4>Problema: es demasiado local.</h4>
					</section>
					<section>
						<h3>Centralidad de Intermediación</h3>
						Mide la capacidad que tiene un nodo para dejar pasar una noticia o no. Los nodos más importantes serán aquellos que hagan de puentes entre comunidades.
						<h4>Mide las corredurías.</h4>
					</section>
                    <section data-background="images/between.png"></section>
					<section>
						Cuanto mayor sea el número de caminos mínimos que pasan por un nodo en concreto, mayor será su nivel de intermediación.
					</section>
					<section>
						<h3>Centralidad de Cercanía</h3>
						En este caso un nodo es más central cuanto más cercano se está al centro de la red, es decir, cuanto más en medio de las cosas estés, más centralidad tendrás.
						<p>No es tan importante el grado.</p>
					</section>
                    <section data-background="images/close.png"></section>
					<section>
						<h3>Centralidad de Vector Propio</h3>
						Mide la centralidad de un nodo en función de cómo de centrales sean sus vecinos. No tiene en cuenta el número de enlaces, sino la calidad de estos.
						<p>No es tan importante el grado.</p>
					</section>
                    <section data-background="images/eigenvec.png"></section>
                </section>
				<section>
					<h2>Otras propiedades</h2>
					<ul>
						<li>Diámetro y radio de la red.</li>
						<li>Distancia media.</li>
						<li>Grado medio.</li>
						<li>Densidad.</li>
						<li>Coeficiente de Clustering.</li>
						<li>Y muchas más.</li>
					</ul>
				</section>                
                <section>
                    <section>
                        <h2>Detección de comunidades</h2>
                        <p>Consiste en detectar subconjuntos de nodos que estén muy <b>interconectados</b> entre sí y que presenten una densidad de enlaces menor con otras zonas del grafo.</p>
                    </section>
                    <section data-background="#fff" data-background-transition="zoom">
                        <img src="http://barabasi.com/networksciencebook/images/ch-09/figure-9-1.jpg" style="height: 50%; width: 50%; box-shadow: none; border:0">

                        <p style="font-size: 20px;"><a style="text-shadow: none;" href="http://barabasi.com/networksciencebook/">Fuente: Network Science - Albert-László Barabási.</a></p>
                    </section>
                    <section><h2>Detección de comunidades</h2></section>
                    <section data-background="./images/comgephi.png"></section>
                    <section><h2>Detección de comunidades más general</h2></section>
                    <section data-background="./images/comBig.png"></section>
                    <section><h2>Detección de comunidades más fina</h2></section>
                    <section data-background="./images/community.png"></section>
                </section>
                <section>
	                <section>
	                	<h2>Resultados del estudio</h2>
	                	<h3>Perfiles más influyentes según la centralidad</h3>
	                </section>
	                <section>        
	                        <div style="width: 100%">
	                            <div style="float: left; width: 45%">
	                                <table style="font-size: 20px">
	                                <thead>
	                                    <tr>
	                                        <th>Nodo</th>
	                                        <th>Intermediación</th>
	                                    </tr>
	                                </thead>
	                                <tbody>
	                                    <tr>
	                                        <td>python_granada</td>
	                                        <td>707790.118829838</td>
	                                    </tr>
	                                    <tr>
	                                        <td>educhip</td>
	                                        <td>292441.1663854712</td>
	                                    </tr>
	                                    <tr>
	                                        <td>HackLabAl</td>
	                                        <td>241062.017686</td>
	                                    </tr>
	                                    <tr>
	                                        <td>PythonEggs</td>
	                                        <td>198534.22310169527</td>
	                                    </tr>
	                                    <tr>
	                                        <td>UGRemprendedora</td>
	                                        <td>178037.331931</td>
	                                    </tr>
	                                </tbody>
	                                </table>
	                            </div>
	                            <div style="float: right; width: 45%">
	                                <table style="font-size: 20px">
	                                <thead>
	                                    <tr>
	                                        <th>Nodo</th>
	                                        <th>Cercanía</th>
	                                    </tr>
	                                </thead>
	                                <tbody>
	                                    <tr>
	                                        <td>pydatasci</td>
	                                        <td>1</td>
	                                    </tr>
	                                    <tr>
	                                        <td>SciPyTip</td>
	                                        <td>1</td>
	                                    </tr>
	                                    <tr>
	                                        <td>minrk</td>
	                                        <td>1</td>
	                                    </tr>
	                                    <tr>
	                                        <td>python_granada</td>
	                                        <td>0.500593</td>
	                                    </tr>
	                                    <tr>
	                                        <td>renatolrr</td>
	                                        <td>0.434579</td>
	                                    </tr>
	                                </tbody>
	                                </table>
	                            </div>
	                            <table style="font-size: 20px">
	                            <thead>
	                                <tr>
	                                    <th>Nodo</th>
	                                    <th>Vector propio</th>
	                                </tr>
	                            </thead>
	                            <tbody>
	                                <tr>
	                                    <td>OSLUGR</td>
	                                    <td>1</td>
	                                </tr>
	                                <tr>
	                                    <td>python_granada</td>
	                                    <td>0.9193289595387109</td>
	                                </tr>
	                                <tr>
	                                    <td>jjmerelo</td>
	                                    <td>0.886500</td>
	                                </tr>
	                                <tr>
	                                    <td>renatolrr</td>
	                                    <td>0.796691</td>
	                                </tr>
	                                <tr>
	                                    <td>CanalUGR</td>
	                                    <td>0.784414</td>
	                                </tr>
	                            </tbody>
	                            </table>
	                        </div>
	                    </section>
                </section>
                <section data-background="https://media.giphy.com/media/3hvmlYNsOTFWE/giphy.gif"></section>
                <section>
                <section><h2>Herramientas para analizar la red</h2>
                    <div style="width: 100%">
                        <div style="width: 100%">
                            <div style="float: left; width: 45%">
                                <a href="https://gephi.org/"><img src="images/gephi.png" style="width: 40%"></a>
                                <ul style="font-size: 25px">
                                    <li>Fácil de usar.</li>
                                    <li>Visualizaciones muy bonitas</li>
                                    <li>Explota cuando sales de las redes de juguete.</li>
                                </ul>
                            </div>
                            <div style="float: right; width: 45%">
                                <a href="https://graph-tool.skewed.de/"><img src="images/graph-tool.png" style="width: 100%"></a>
                                <ul style="font-size: 25px;">
                                    <li>Herramienta para Python.</li>
                                    <li>Extremadamente eficiente.</li>
                                    <li>Es un poco más complicado de usar, pero ofrece muy buenas visualizaciones.</li>
                                    <li>Se puede integrar con <i>Graphviz</i>.</li>
                                    <li>Funciona muy bien incluso con redes de millones de nodos.</li>
                                </ul>
                            </div>
                        <div style="clear: both;"></div>
                    </div>
                    </section>
                    <section><h2>Herramientas para analizar la red</h2>
                    <div style="width: 100%">
                            <div style="float: left; width: 45%">
                                <a href="http://igraph.org/"><img src="http://igraph.org/img/igraph3.svg" style="width: 40%"></a>
                                <ul style="font-size: 25px">
                                    <li><b>igraph</b> es un paquete para R, Python y C.</li>
                                    <li>En R, existe el paquete <b>igraphdata</b> que incluye varios datasets.</li>
                                    <li>Incluye muchas operaciones con grafos y redes.</li>
                                </ul>
                            </div>
                            <div style="float: right; width: 45%">
                                <a href="https://networkx.github.io/">NetworkX</a>
                                <ul style="font-size: 25px;">
                                    <li>Herramienta para Python.</li>
                                    <li>Incluye muchas operaciones con grafos y redes.</li>
                                    <li>Define estructuras de datos para grafos y multigrafos.</li>
                                    <li>Buena documentación y con ejemplos.</li>
                                </ul>
                            </div>
                        </div>
                        <div style="clear: both;"></div>
                    </section>
                </section>
                <section data-background="https://media.giphy.com/media/6aWiWDs9FtnDG/giphy.gif">
                	<h2>¿Preguntas?</h2>
                </section>
                <section data-background="https://media.giphy.com/media/HmIkHqoyhY9Vu/giphy.gif">
                	<h1>Gracias!! :D</h1>
                </section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
